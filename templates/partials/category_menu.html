{% load static %}

{% for item in categories %}
    <div class="category-item" data-level="{{ item.category.get_level }}">
        <a href="{% url 'category_products' item.category.slug %}" 
           class="category-link d-flex align-items-center justify-content-between">
            <div class="d-flex align-items-center">
                {% if item.category.image %}
                    <img src="{{ item.category.image.url }}" 
                         alt="{{ item.category.name }}" 
                         class="category-icon me-2">
                {% else %}
                    <i class="fas fa-folder me-2 category-icon-fallback"></i>
                {% endif %}
                <span>{{ item.category.name }}</span>
                <span class="badge bg-light text-dark ms-2 small">{{ item.category.products.count }}</span>
            </div>
            {% if item.children %}
                <i class="fas fa-chevron-right category-arrow"></i>
            {% endif %}
        </a>
        
        {% if item.children %}
            <div class="subcategory-container">
                {% include 'partials/category_menu.html' with categories=item.children %}
            </div>
        {% endif %}
    </div>
{% endfor %}

<style>
.category-item {
    border-bottom: 1px solid rgba(0,0,0,0.05);
}

.category-link {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    color: #333;
    text-decoration: none;
    transition: all 0.2s ease;
    background: transparent;
}

.category-link:hover {
    background-color: #f8f9fa;
    color: #0d6efd;
    text-decoration: none;
}

.category-icon {
    width: 24px;
    height: 24px;
    object-fit: cover;
    border-radius: 4px;
}

.category-icon-fallback {
    width: 24px;
    text-align: center;
    color: #6c757d;
}

.category-arrow {
    font-size: 12px;
    color: #6c757d;
    transition: transform 0.2s ease;
}

.subcategory-container {
    margin-left: 20px;
    border-left: 2px solid #e9ecef;
}

.subcategory-container .category-link {
    padding-left: 24px;
    font-size: 0.9rem;
}

.subcategory-container .category-item {
    border-bottom: 1px solid rgba(0,0,0,0.03);
}

.subcategory-container .subcategory-container {
    margin-left: 16px;
}

.subcategory-container .subcategory-container .category-link {
    padding-left: 20px;
    font-size: 0.85rem;
    color: #6c757d;
}

.all-categories {
    background: linear-gradient(135deg, #0d6efd, #0056b3);
    color: white !important;
    font-weight: 500;
    margin-top: 8px;
    border-radius: 6px;
}

.all-categories:hover {
    background: linear-gradient(135deg, #0056b3, #004085);
    color: white !important;
}

/* Mobile specific styles */
@media (max-width: 768px) {
    .category-link {
        padding: 14px 16px;
        font-size: 1rem;
    }
    
    .subcategory-container .category-link {
        padding-left: 32px;
    }
}
</style>
